#include "gfx.h"
#include "ssd1306.h"
#include "font5x7.h"

void GFX_DrawPixel(uint8_t x, uint8_t y, uint8_t color)
{
    if (x >= 128 || y >= 32) return;

    if (color)
        SSD1306_Buffer[x + (y / 8) * 128] |= (1 << (y % 8));
    else
        SSD1306_Buffer[x + (y / 8) * 128] &= ~(1 << (y % 8));
}

void SSD1306_DrawChar(uint8_t x, uint8_t y, char c)
{
    if (c < 32 || c > 127) return;

    for (uint8_t col = 0; col < 5; col++)
    {
        uint8_t line = Font5x7[c - 32][col];
        for (uint8_t row = 0; row < 7; row++)
        {
            if (line & (1 << row))
                GFX_DrawPixel(x + col, y + row, 1);
        }
    }
}

void SSD1306_DrawString(uint8_t x, uint8_t y, const char *str)
{
    while (*str)
    {
        SSD1306_DrawChar(x, y, *str++);
        x += 6;
    }
}
